<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<style>
  body {
    margin: 0;
    background: #222;
    overflow: hidden;
    position: relative;
  }
  .layer {
    position: absolute;
    top: 50px;
    left: 50px;
    width: 80%;
    height: 80%;
  }
  iframe {
    width: 100%;
    height: 100%;
    border: none;
  }
</style>
</head>
<body>
<script>
  const layers = {};

  window.addEventListener('message', e => {
    const { type, code, layer } = e.data;
    if (type === 'updatePreview' && layer && code) {
      let el = document.getElementById('layer' + layer);

      if (!el) {
        el = document.createElement('div');
        el.id = 'layer' + layer;
        el.className = 'layer';
        document.body.appendChild(el);
      }

      // Clear previous content
      el.innerHTML = '';

      // Create iframe for full HTML rendering
      const iframe = document.createElement('iframe');
      iframe.srcdoc = code; // render full HTML including head/body/styles
      el.appendChild(iframe);

      layers[layer] = code;
    }
  });
</script>
</body>
</html>
